/*! jPlayer Jukebox add-on 0.5.0 (http://www.gyrocode.com/projects/jplayer-jukebox) ~ (c) Gyrocode.com ~ MIT License */
(function(a,b){jPlayerJukebox=function(d){var c=this;this.id="jplayer_jukebox";this.options=a.extend({},this._options,d);if(typeof d.jukeboxOptions!=="undefined"){this.options.jukeboxOptions=a.extend({},this._options.jukeboxOptions,d.jukeboxOptions)}if(c.options.jukeboxOptions.position!=="float-bl"&&c.options.jukeboxOptions.position!=="fixed-t"&&c.options.jukeboxOptions.position!=="fixed-b"){c.options.jukeboxOptions.position=this._options.jukeboxOptions.position}this._construct();this.j=a("#"+c.id+"_container");this.p=a("#"+c.id);this.pl=new jPlayerPlaylist({jPlayer:"#"+c.id,cssSelectorAncestor:"#"+c.id+"_container"},[],this.options);this.trackCur=null;this.typesSupported={mp3:"mp3",m4a:"m4a",oga:"oga,ogg",fla:"fla,flac",wav:"wav",webma:"webma,weba"};this.p.bind(a.jPlayer.event.ready,function(f){c._onReady(f)});this.p.bind(a.jPlayer.event.play,function(f){c._onPlay(f)});this.p.bind(a.jPlayer.event.pause,function(f){c._onPause(f)});this.p.bind(a.jPlayer.event.resize,function(f){c._onResize(f)})};jPlayerJukebox.prototype={_options:{jukeboxOptions:{position:"float-bl",className:"ui-gradient"},playlistOptions:{enableRemoveControls:true},supplied:"mp3",smoothPlayBar:true,keyEnabled:true,audioFullScreen:false,autohide:{minimize:true,restored:false},useStateClassSkin:true},_construct:function(){var c=this;var d='<div id="'+c.id+'_container" class="jp-jukebox" style="visibility:hidden" role="application" aria-label="media player"><div class="jp-playlist jp-gui-bg"><div class="jp-gui-texture"></div><ul><li></li></ul></div><div id="'+c.id+'" class="jp-jplayer"></div><div class="jp-gui jp-gui-bg">   <div class="jp-gui-texture"></div>   <div class="jp-gui-gradient"></div>   <div class="jp-interface">      <div class="jp-progress">         <div class="jp-seek-bar">            <div class="jp-play-bar"></div>         </div>      </div>      <div class="jp-current-time" role="timer" aria-label="time"></div>      <div class="jp-duration" role="timer" aria-label="duration"></div>      <div class="jp-controls-holder">         <div class="jp-controls">            <button class="jp-previous" role="button" tabindex="0" title="Previous track">previous</button>            <button class="jp-play" role="button" tabindex="0" title="Play">play</button>            <button class="jp-stop" role="button" tabindex="0">stop</button>            <button class="jp-next" role="button" tabindex="0" title="Next track">next</button>         </div>         <div class="jp-volume-controls">            <button class="jp-mute" role="button" tabindex="0" title="Mute">mute</button>            <button class="jp-volume-max" role="button" tabindex="0" title="Max volume">max volume</button>            <div class="jp-volume-bar">               <div class="jp-volume-bar-value"></div>            </div>         </div>         <div class="jp-toggles">            <button class="jp-repeat" role="button" tabindex="0" title="Repeat all">repeat</button>            <button class="jp-shuffle" role="button" tabindex="0" title="Shuffle">shuffle</button>            <button class="jp-full-screen" role="button" tabindex="0" title="Full screen">full screen</button>            <button class="jp-show-playlist" role="button" tabindex="0" title="Playlist">playlist</button>         </div>      </div>      <div class="jp-details">         <div class="jp-title" aria-label="title"></div>      </div>      <div class="jp-app-bar"><a href="http://www.gyrocode.com/projects/jplayer-jukebox" target="_blank">jPlayer Jukebox</a></div>      <div class="jp-visibility-control jp-gui-bg"><div class="jp-gui-texture"></div><div class="jp-gui-gradient"></div><button class="jp-visibility-toggle" role="button" tabindex="0">&times;</button></div>   </div></div><div class="jp-no-solution">   <span>Update Required</span>   To play the media you will need to either update your browser to a recent version or update your <a href="http://get.adobe.com/flashplayer/" target="_blank">Flash plugin</a>.</div></div>';a("body").append(d)},_getFilenameFromUrl:function(c){var d=c;index=d.indexOf("?");if(index!=-1){d=d.substring(0,index)}index=d.lastIndexOf("/");if(index!=-1){d=d.substring(index+1)}return d},_getTypeFromUrl:function(f){var m=this;var k=null;try{var j=f;var h=j.indexOf("://");var g=false;if(h!=-1){g=true;j=j.substring(h+3)}h=j.indexOf("?");if(h!=-1){j=j.substring(0,h)}h=j.lastIndexOf("/");var d=false;if(h!=-1){d=true;j=j.substring(h+1)}h=j.lastIndexOf(".");if((!g||d)&&h!=-1){var l=j.substring(h+1,j.length).toLowerCase();for(var c in m.typesSupported){if(m.typesSupported.hasOwnProperty(c)){if(a.inArray(l,m.typesSupported[c].split(","))!=-1){k=c;break}}}if(a.inArray(k,m.options.supplied.split(","))==-1){k=null}}return k}catch(i){return k}},_onReady:function(d){var c=this;a(".jp-playlist").slideUp(0);a(".jp-show-playlist").click(function(f){if(c.j.hasClass("jp-state-playlist")){c.j.removeClass("jp-state-playlist");a(".jp-playlist").slideUp(400)}else{c.j.addClass("jp-state-playlist");a(".jp-playlist").slideDown(400)}});a("#"+c.id+"_container").css("visibility","visible").addClass("jp-pos-"+c.options.jukeboxOptions.position).addClass(c.options.jukeboxOptions.className);if(c.options.jukeboxOptions.position==="float-bl"){c.setVisibility(!c.options.autohide.minimize,0);a(".jp-visibility-toggle").click(function(g){var f=a(this);c.setVisibility((a("#"+c.id+"_container").hasClass("jp-visibility-off")),400)})}a(".jp-details").show();this.parsePage()},parsePage:function(f){var k=this;var c=a("a").not(".jp-page-link");var h=[];var j=k.pl.playlist.length;var d,m,g;for(d=0;d<c.length;d++){m=a(c[d]);if(m.hasClass("jp-media")){g=k._getTypeFromUrl(m.attr("href"));if(g){h.push({el:m,type:g,id:j+h.length,time:0})}}}if(!h.length){for(d=0;d<c.length;d++){m=a(c[d]);g=k._getTypeFromUrl(m.attr("href"));if(g){h.push({el:m,type:g,id:j+h.length,time:0})}}}for(d=0;d<h.length;d++){track=h[d];track.btn=a("<span />",{"class":"jp-page-btn-play"});track.btn.click({track:track},function(i){k._onClick(i)});var l={title:(track.el.attr("title"))?track.el.attr("title"):k._getFilenameFromUrl(track.el.attr("href")),artist:(track.el.data("artist"))?track.el.data("artist"):"",track:track};l[track.type]=track.el.attr("href");k.pl.add(l);track.el.before(track.btn);track.el.addClass("jp-page-link");track.el.click({track:track},function(i){k._onClick(i)})}},_onClick:function(k){var f=this;var d=k.data.track;if(d.btn.hasClass("jp-page-btn-pause")){f.p.jPlayer("pause")}else{var c=false;var h=0;if(f.trackCur){if(d.id==f.trackCur.id){h=f.trackCur.time;c=true}else{f.trackCur.time=0}}var g;if(h===0){for(g=0;g<f.pl.playlist.length;g++){playlistItem=f.pl.playlist[g];if(playlistItem.track.id==d.id){f.pl.select(g);c=true;break}}}if(c){f.p.jPlayer("play",h)}else{var j={track:d};j[d.type]=d.el.attr("href");f.p.jPlayer("setMedia",j);f.p.jPlayer("play",h)}}k.preventDefault()},setVisibility:function(f,e){var c=this;if(f){a("#"+c.id+"_container").finish().animate({left:"0"},e,function(){a(this).addClass("jp-visibility-on").removeClass("jp-visibility-off")})}else{var d=a("#"+c.id+"_container").outerWidth();a("#"+c.id+"_container").finish().animate({left:"-"+(d+1)+"px"},e,function(){a(this).addClass("jp-visibility-off").removeClass("jp-visibility-on")})}},_onPlay:function(d){var c=this;c.trackCur=d.jPlayer.status.media.track;if(a(".jp-page-btn-pause").length){a(".jp-page-btn-pause").removeClass("jp-page-btn-pause").addClass("jp-page-btn-play")}c.trackCur.btn.removeClass("jp-page-btn-play").addClass("jp-page-btn-pause")},_onPause:function(f){var d=this;if(d.trackCur){if(!f.jPlayer.status.ended){d.trackCur.time=f.jPlayer.status.currentTime}else{d.trackCur.time=0}}var c=f.jPlayer.status.media.track;c.btn.removeClass("jp-page-btn-pause").addClass("jp-page-btn-play")},_onResize:function(d){var c=this;if(a(".jp-playlist-on").css("display")!=="none"){if(d.jPlayer.options.fullScreen){a(".jp-playlist").slideDown(0)}else{a(".jp-playlist").slideUp(0)}}}}})(jQuery);